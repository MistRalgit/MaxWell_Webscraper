# MaxWell Webscraper

汎用的なウェブスクレイピングツール（Selenium + Django + Pandas）

## 概要

MaxWell Webscraperは、Seleniumを使用してウェブサイトからデータを抽出するための汎用的なスクレイピングツールです。直感的なGUIを提供し、非エンジニアでも簡単に様々なウェブサイトからデータを収集できるように設計されています。

## 主な機能

- **複数URL対応**: 複数のURLからデータを抽出できます
- **CSSセレクタ**: CSSセレクタを使用して必要なデータを特定
- **ログイン対応**: ログインが必要なサイトにも対応
- **ページネーション**: 複数ページにわたるデータの抽出が可能
- **画像ダウンロード**: 画像を自動的にダウンロード
- **CSVエクスポート**: 抽出したデータをCSVファイルとして保存
- **セレクタテスト**: セレクタが正しく動作するかテスト機能付き

## 技術仕様

- **Python**: 3.10.6
- **Django**: 4.2.0
- **Selenium**: 4.10.0
- **Pandas**: 2.0.0
- **対応OS**: Windows 11（主な対象環境）

## インストール方法

### 前提条件

- Python 3.10.6以上がインストールされていること
- Google Chromeがインストールされていること

### インストール手順

1. リポジトリをクローンまたはダウンロードします

```
git clone https://github.com/yourusername/maxwell-webscraper.git
cd maxwell-webscraper
```

2. 仮想環境をセットアップして有効化します

```
python -m venv venv
venv\Scripts\activate
```

3. 必要なパッケージをインストールします

```
pip install -r requirements.txt
```

4. Djangoのマイグレーションを実行します

```
python manage.py migrate
```

## 使用方法

1. バッチファイルをダブルクリックするか、以下のコマンドでアプリケーションを起動します

```
python manage.py runserver
```

2. ブラウザで http://127.0.0.1:8000/ にアクセスします

3. UIから以下の設定を行います：
   - スクレイピング対象のURLを入力
   - 抽出したいデータのCSSセレクタを指定
   - 必要に応じてログイン設定、ページネーション設定、画像ダウンロード設定を行う
   - 出力パスを指定（デフォルトは「output」フォルダ）

4. 「スクレイピング実行」ボタンをクリックして処理を開始します

5. 実行ログは右パネルに表示され、結果はCSVファイルとして保存されます

## セレクタの使い方

CSSセレクタは以下のような形式で指定できます：

- **要素名**: `div`（すべてのdiv要素）
- **クラス**: `.className`（特定のクラスを持つ要素）
- **ID**: `#elementId`（特定のIDを持つ要素）
- **属性**: `input[name='username']`（name属性が'username'の入力要素）

詳細はアプリケーションの「ヘルプ」タブを参照してください。

## 注意事項

- ウェブサイトのスクレイピングを行う際は、対象サイトの利用規約をご確認ください
- 過剰なリクエストを送信しないよう、適切な間隔を設けてください
- 個人情報や機密情報の取り扱いには十分ご注意ください

## トラブルシューティング

- **Chromeドライバーのエラー**: `webdriver-manager`が自動的に適切なChromeドライバーをダウンロードしますが、問題が発生する場合は[ChromeDriverのwebサイト](https://chromedriver.chromium.org/downloads)から手動でインストールしてください。
- **要素が見つからない**: JavaScriptで動的に生成される要素の場合、ページの読み込みが完了していない可能性があります。セレクタテスト機能で確認してください。
- **実行が遅い**: サーバーの応答時間やネットワーク速度に依存します。また、大量のデータを取得する場合は時間がかかる場合があります。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 作者

MistRal
